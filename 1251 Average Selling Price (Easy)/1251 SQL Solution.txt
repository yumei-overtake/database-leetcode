/* Write your T-SQL query statement below */
SELECT p.product_id,
       isnull(round(sum(p.price*units*1.0)/sum(units),2),0) as average_price 
FROM Prices as p
left join unitsSold as U 
        on p.product_id =u.product_id
        and u.purchase_date>=start_date
        and u.purchase_date<=end_date
group by  p.product_id