/* Write your T-SQL query statement below */
SELECT s.user_id,
       isnull(round(avg(case when action='confirmed' then 1.0 else 0 end),2),0) as confirmation_rate 
FROM signups as s
LEFT JOIN confirmations as c 
            on s.user_id=c.user_id
group by s.user_id