/* Write your T-SQL query statement below */
With t as (
    select employee_id
    from employee
    group by employee_id
    having count(*)=1
)

SELECT employee_id,
       department_id
FROM Employee
where primary_flag='Y' 
or employee_id in (select employee_id from t)