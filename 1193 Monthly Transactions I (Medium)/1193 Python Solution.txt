import pandas as pd

def monthly_transactions(transactions: pd.DataFrame) -> pd.DataFrame:
    # 1. Format date
    transactions['month'] = transactions['trans_date'].dt.strftime('%Y-%m')
    
    transactions['approved_cnt']= np.where(transactions['state']=='approved',1,0)
    transactions['approved_amt']= np.where(transactions['state']=='approved',transactions['amount'],0)
    df = transactions.groupby(['month','country'], dropna=False).agg (
        trans_count=('id','count') ,
        approved_count=('approved_cnt','sum'),
        trans_total_amount=('amount','sum'),
        approved_total_amount =('approved_amt','sum')
    ).reset_index()

    return df


# in pandas, the groupby method excludes rows with NaN (null) values in the grouping columns by default. 
#In LeetCode 1193, some transactions have a null country, and these are being dropped from your result. 
# groupby (dropna=False) is the key

# get date time from a date  .dt.strftime('%Y-%m')