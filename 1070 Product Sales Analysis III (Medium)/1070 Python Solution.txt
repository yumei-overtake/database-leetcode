import pandas as pd

def sales_analysis(sales: pd.DataFrame) -> pd.DataFrame:
    sales['first_year']= sales.groupby('product_id')['year'].transform('min')
    return sales[sales['year']==sales['first_year']][['product_id','first_year','quantity','price']]



#use transform('min') instead of min() will return min of each group to the original index. ***